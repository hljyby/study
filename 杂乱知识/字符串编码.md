# 字符串编码及Python字符串编码

1、**字符与字节有什么区别**

**（一）字节**

字节（Byte）是一种计量单位，表示数据量多少，主要用于**存储**和**网络传输。**1 byte=8 bit （KB,M）

**（二）字符**

字符是指计算机中使用的文字和符号，比如1、2、3、A、B、C、~！·#￥%……

**（三）“字节”与“字符”**

它们**完全不是一个位面的概念**，**不同编码里，字符和字节的对应关系不同：**

***①\*ASCII**码中，一个英文字母（不分大小写）占一个字节的空间，**一个中文汉字占两个字节**的空间。一个[二进制数字](https://link.zhihu.com/?target=https%3A//www.baidu.com/s%3Fwd%3D%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%95%B0%E5%AD%97%26tn%3D44039180_cpr%26fenlei%3Dmv6quAkxTZn0IZRqIHckPjm4nH00T1YLPANWnW01uH6suhf3nWmk0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EPjRYPjnvPH63nHmLnWRvPHcd)序列，在计算机中作为一个数字单元，一般为8位二进制数，换算为十进制。最小值0，最大值255。

***②\*UTF-8**编码中，**一个英文字符=一个字节，一个中文（含繁体）=三个字节。**

***③\*Unicode**编码中，**一个英文等于=两字节，一个中文（含繁体）=两个字节。**

符号：英文标点占一个字节，中文标点占两个字节。举例：英文句号“.”占1个字节的大小，中文句号“。”占2个字节的大小。

![img](https://pic4.zhimg.com/80/v2-16a22e08872d8372599d8c69afb96f07_720w.png)x表示无的意思,utf8英文省空间

**字符（不同方式编码给人看），字节（计算机看）**

![img](https://pic1.zhimg.com/80/v2-b37b05418af6295dc1753aa9efa5df80_720w.jpg)



**ASCII**:最早只有127个字符被编码到计算机里，也就是大**小写英文字母、数字和一些符号**，这个编码表被称为`ASCII`编码，比如大写字母`A`的编码是`65`。

```text
我们平时说的 ASCII 其实有两个含义，一个是 ASCII 字符集，另一个是 ASCII 编码。

ASCII 字符集只是定义了字符与字符码（character code，也称 code point 代码点）的对应关系。也就是说这一层面只是规定了字符A用 65 表示，至于
这个 65 在内存或硬盘中怎么表示，它不管，那是 ASCII 编码做的事。

ASCII 编码规定了用 7 个二进制位保存 ASCII 字符码(定义字符集的存储形式)，剩下 1 位为 Parity bit，也称为校验位，用以检查数据的正确性。
```

**Unicode**把所有语言都统一到一套编码里，不会有乱码问题。(所有文字用这个)。

**UTF-8**:本着节约的精神，把Unicode编码转化为“可变长编码”的`UTF-8`编码。UTF-8编码把一个Unicode字符根据不同的数字大小编码成1-6个字节，**常用的英文字母被编码成1个字节，汉字通常是3个字节，只有很生僻的字符才会被编码成4-6个字节**。如果你要传输的文本包含大量英文字符，用UTF-8编码就能节省空间。

```text
>>> '中'.encode('ascll')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
LookupError: unknown encoding: ascll
>>> '中'.encode('utf-8') #编码encode给计算机看
b'\xe4\xb8\xad'
>>> b'\xe4\xb8\xad'
b'\xe4\xb8\xad'
>>> b'\xe4\xb8\xad'.decode('utf-8') #解码decode给人看
'中'
```

![img](https://pic1.zhimg.com/80/v2-1c6d70377bfaa343f20a8c2d2cdd7f50_720w.jpg)字符、代码点、二进制字节关系图

```text
Character 字符。即我们看到的单个符号，像“A”、“啊”等
Code point 代码点。一个无符号数字，通常用16进制表示。代码点与字符的一一对应关系称为字符集（Character Set），这种对应关系肯定不止一种，也
就导致了不同字符集的出现，像 ASCII、ISO-8859-1、GB2312、GBK、Unicode 等。
Bytes 二进制字节。其含义为代码点在内存或磁盘中的表示形式。代码点与二进制字节的一一对应关系称为编码（Encoding），当然这种对应关系也不是唯
一的，所以编码也有很多种，像 ASCII、ISO-8859-1、ENC-CN、GBK、UTF-8等。
```



在计算机**内存中，统一使用Unicode**编码，当需要保存到**硬盘或者需要传输的时候，就转换为UTF-8编码**。

![img](https://pic1.zhimg.com/80/v2-f1695efc6a0c7e9e9ab6e152937b98f0_720w.jpg)

用记事本编辑的时候，从文件读取的UTF-8字符被转换为Unicode字符到**内存**里，编辑完成后，保存的时候再把Unicode转换为UTF-8保存到文件。

![img](https://pic2.zhimg.com/80/v2-83f38828f1fb4eae4377de56441250dd_720w.jpg)记事本存在硬盘上面

浏览网页的时候，服务器会把动态生成的Unicode内容转换为UTF-8再传输到浏览器：

![img](https://pic2.zhimg.com/80/v2-c58f8fc91ead25575d925c09c2733f39_720w.jpg)也是存在硬盘上面

**Python 3版本中，字符串以Unicode**编码

```text
>>> print('包含中文的str')
包含中文的str
```

Python的字符串类型是`str`，在**内存中以Unicode**表示，一个字符对应若干个字节。如果要在**网络上传输，或者保存到磁盘上，就需要把`str`变为以字节为单位的`bytes`。**

**Python对`bytes`类型的数据用带`b`前缀的单引号或双引号表示**：

```ini
x = b'ABC'
```

要注意区分`'ABC'`和`b'ABC'`，前者是`str`，后者虽然内容显示得和前者一样，但**`bytes`的每个字符都只占用一个字节**。

以Unicode表示的`str`通过`encode()`方法可以编码为指定的`bytes`，例如:

```text
>>> 'ABC'.encode('ascii') #utf8占3字节
b'ABC' #还是3字节
>>> '中文'.encode('utf-8')
b'\xe4\xb8\xad\xe6\x96\x87'
>>> '中文'.encode('ascii')  #无
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
UnicodeEncodeError: 'ascii' codec can't encode characters in position 0-1: ordinal not in range(128)
```

**如果`bytes`中只有一小部分无效的字节，可以传入`errors='ignore'`忽略错误的字节：**

```python
>>> b'\xe4\xb8\xad\xff'.decode('utf-8', errors='ignore')
'中'
```

由于Python源代码也是一个文本文件，所以，**当你的源代码中包含中文的时候，在保存源代码时，就需要务必指定保存为UTF-8编码。当Python解释器读取源代码时，为了让它按UTF-8编码读取**，我们通常在文件开头写上这两行：

```text
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
```

第一行注释是为了告诉Linux/OS X系统，这是一个Python可执行程序，Windows系统会忽略这个注释；

第二行注释是为了告诉Python解释器，按照UTF-8编码读取源代码，否则，你在源代码中写的中文输出可能会有乱码。

## **格式化**

![img](https://pic1.zhimg.com/80/v2-1e4a922af164c224ce5cf1f35e4053f4_720w.jpg)



![img](https://pic4.zhimg.com/80/v2-9664c43b07fbd5cf223405a6b0fc7c0f_720w.jpg)



![img](https://pic4.zhimg.com/80/v2-04158a81c8f8af6233c6ea507704fd8b_720w.jpg)

**format()**

```text
>>> 'Hello, {0}, 成绩提升了 {1:.1f}%'.format('小明', 17.125)
'Hello, 小明, 成绩提升了 17.1%'
```

当`str`和`bytes`互相转换时，需要指定编码。最常用的编码是`UTF-8`。Python当然也支持其他编码方式，比如把Unicode编码成`**GB2312**`：

```python
>>> '中文'.encode('gb2312')
b'\xd6\xd0\xce\xc4'
```

但这种方式纯属自找麻烦，如果没有特殊业务要求，请牢记仅使用`UTF-8`编码。

# 自己的理解

- 计算机内存所使用的编码方式为unicode 编码 （统一字符编码，就是你算看到的界面所使用的编码）
- 你在计算机上所看到的数字，汉字，一切字符都是这个编码
- 当我们在打开一个文件的时候，cpu 会控制内存新建缓冲区 缓存这个文件的所有东西，如果他是通过utf8编码的文件，那么在这块缓冲区内，就会存着这个文件通过utf8解码生成的unicode 二进制串（流）
- 计算机的所有东西都是二进制的串，他叫bytes,我们看到的东西是，这些bytes 经过unicode 字符集一一对应后的结果
- 在写入一个文件的时候，unicode 的二进制串会通过utf8 编码生成属于utf8编码的二进制串，保存在磁盘中，怎么保存，地址是什么我就没研究了。
- BytesIO 这个模块 在我看来就是在内存中的磁盘，他在内存中创建一个缓冲区，用来存储经过编码的二进制数据，也就是说他可以存储经过utf8编码的二进制数据，这不就是磁盘吗，磁盘里存储的不就是进过utf8编码的unicode 二进制数据吗。他可以有open操作，读操作，write操作，getvalue操作
- u/ 后面存储的是unicode 的二进制数据，在计算机中他和直接写字符串没有区别
- b' ' 后面是表示这个东西是二进制数据，他是通过ascii 进行编码的
- ascii 码 所有东西对应一个字节 大小写字母 一部分符号,没有中文
- utf8 英文对应一个字节，汉字对应三个字节，有复杂的对应4-6个字节
- unicode 汉字两个字节 ，英文两个字节 ， 
- 当传输的数据是全英文的时ascii 码 编码的数据和 utf8编码的数据是一样的二进制数